function addLog(e,a,n,t){var r=document.createElement("div");e.appendChild(r);r.innerHTML=data_bytes.slice(index,index+n+a).join("-")+" - "+t,index+=a+n}function selectPacket(e,a){console.log("selectPacket. start: %s, size: %s",e,a),document.getElementById("dlmsPacket").focus(),document.getElementById("dlmsPacket").setSelectionRange(3*e,3*(e+a)-1)}function parse(){var e=document.querySelector("#dlmsPacket"),a=e.value;index=0,a=a.replace(/[-_ ]/g,""),data_bytes=a.match(/.{2}/g),e.value=data_bytes.join("-"),console.log("data_bytes.length: %s",data_bytes.length);var n=parseInt(data_bytes[index],16),t=document.createDocumentFragment();parseFuncs[n](t);for(var r=document.querySelector("#log");r.firstChild;)r.removeChild(r.firstChild);r.appendChild(t)}function fullPacket(e){addLog(e,1,4,"Integer32 = "+val);var a=parseInt(data_bytes[index],16);parseFuncs[a](fragment)}function parseArray(e){var a=document.createElement("div");e.appendChild(a);var n=parseInt(data_bytes[index+1],16);a.innerHTML=data_bytes.slice(index,index+2).join("-")+" - Массив размером "+n,index+=2;for(var t=0;n>t;t++){var r=parseInt(data_bytes[index],16);parseFuncs[r](a)}}function parseStruct(e){var a=document.createElement("div");e.appendChild(a);var n=parseInt(data_bytes[index+1],16);a.innerHTML=data_bytes.slice(index,index+2).join("-")+" - Структура размером "+n,index+=2;for(var t=0;n>t;t++){var r=parseInt(data_bytes[index],16);parseFuncs[r](a)}}function parseInteger32(e){var a=parseInt(data_bytes[index+1],16);addLog(e,1,4,"Integer32 = "+a)}function parseUnsigned32(e){var a=parseInt(data_bytes[index+1],16);addLog(e,1,4,"Unsigned32 = "+a)}function parseString(e){var a=parseInt(data_bytes[index+1],16);addLog(e,2,a,"Строка")}function parseInteger8(e){var a=parseInt(data_bytes[index+1],16);addLog(e,1,1,"Integer8 = "+a)}function parseInteger16(e){var a=parseInt(data_bytes[index+1]+data_bytes[index+2],16);addLog(e,1,2,"Integer16 = "+a)}function parseUnsigned8(e){var a=parseInt(data_bytes[index+1],16);addLog(e,1,1,"Unsigned8 = "+a)}function parseUnsigned16(e){var a=parseInt(data_bytes[index+1]+data_bytes[index+2],16);addLog(e,1,2,"Unsigned16 = "+a)}function parseInteger64(e){var a="hz";addLog(e,1,8,"Integer64 = "+a)}function parseUnsigned64(e){var a="hz";addLog(e,1,8,"Unsigned64 = "+a)}function parseFloat32(e){var a="hz";addLog(e,1,4,"Float32 = "+a)}function parseFloat64(e){var a="hz";addLog(e,1,8,"Float64 = "+a)}function parseDateTime(e){var a="hz";addLog(e,1,12,"DateTime = "+a)}function parseDate(e){var a="hz";addLog(e,1,5,"Date = "+a)}function parseTime(e){var a="hz";addLog(e,1,4,"Time = "+a)}var parseFuncs={1:parseArray,2:parseStruct,5:parseInteger32,6:parseUnsigned32,9:parseString,15:parseInteger8,16:parseInteger16,17:parseUnsigned8,18:parseUnsigned16,20:parseInteger64,21:parseUnsigned64,23:parseFloat32,24:parseFloat64,25:parseDateTime,26:parseDate,27:parseTime,126:fullPacket},index=0,data_bytes=[];